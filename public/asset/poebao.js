(function(b){b.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};function a(d){if(typeof d.data!=="string"){return}var c=d.handler,e=d.data.toLowerCase().split(" ");d.handler=function(n){if(this!==n.target&&(/textarea|select/i.test(n.target.nodeName)||n.target.type==="text")){return}var h=n.type!=="keypress"&&b.hotkeys.specialKeys[n.which],o=String.fromCharCode(n.which).toLowerCase(),k,m="",g={};if(n.altKey&&h!=="alt"){m+="alt+"}if(n.ctrlKey&&h!=="ctrl"){m+="ctrl+"}if(n.metaKey&&!n.ctrlKey&&h!=="meta"){m+="meta+"}if(n.shiftKey&&h!=="shift"){m+="shift+"}if(h){g[m+h]=true}else{g[m+o]=true;g[m+b.hotkeys.shiftNums[o]]=true;if(m==="shift+"){g[b.hotkeys.shiftNums[o]]=true}}for(var j=0,f=e.length;j<f;j++){if(g[e[j]]){return c.apply(this,arguments)}}}}b.each(["keydown","keyup","keypress"],function(){b.event.special[this]={add:a}})})(jQuery);
(function(n,i,k){i.infinitescroll=function y(B,D,C){this.element=i(C);if(!this._create(B,D)){this.failed=true}};i.infinitescroll.defaults={loading:{finished:k,finishedMsg:"<em>Congratulations, you've reached the end of the internet.</em>",img:"http://www.infinite-scroll.com/loading.gif",msg:null,msgText:"<em>Loading the next set of posts...</em>",selector:null,speed:"fast",start:k},state:{isDuringAjax:false,isInvalidPage:false,isDestroyed:false,isDone:false,isPaused:false,currPage:1},callback:k,debug:false,behavior:k,binder:i(n),nextSelector:"div.navigation a:first",navSelector:"div.navigation",contentSelector:null,extraScrollPx:150,itemSelector:"div.post",animate:false,pathParse:k,dataType:"html",appendCallback:true,bufferPx:40,errorCallback:function(){},infid:0,pixelsFromNavToBottom:k,path:k};i.infinitescroll.prototype={_binding:function g(D){var B=this,C=B.options;C.v="2.0b2.111027";if(!!C.behavior&&this["_binding_"+C.behavior]!==k){this["_binding_"+C.behavior].call(this);return}if(D!=="bind"&&D!=="unbind"){this._debug("Binding value  "+D+" not valid");return false}if(D=="unbind"){(this.options.binder).unbind("smartscroll.infscr."+B.options.infid)}else{(this.options.binder)[D]("smartscroll.infscr."+B.options.infid,function(){B.scroll()})}this._debug("Binding",D)},_create:function s(B,E){var C=i.extend(true,{},i.infinitescroll.defaults,B);if(!this._validate(B)){return false}this.options=C;var D=i(C.nextSelector).attr("href");if(!D){this._debug("Navigation selector not found");return false}C.path=this._determinepath(D);C.contentSelector=C.contentSelector||this.element;C.loading.selector=C.loading.selector||C.contentSelector;C.loading.msg=i('<div id="infscr-loading"><img alt="Loading..." src="'+C.loading.img+'" /><div>'+C.loading.msgText+"</div></div>");(new Image()).src=C.loading.img;C.pixelsFromNavToBottom=i(document).height()-i(C.navSelector).offset().top;C.loading.start=C.loading.start||function(){i(C.navSelector).hide();C.loading.msg.appendTo(C.loading.selector).show(0,function(){beginAjax(C)})};C.loading.finished=C.loading.finished||function(){C.loading.msg.hide()};C.callback=function(F,G){if(!!C.behavior&&F["_callback_"+C.behavior]!==k){F["_callback_"+C.behavior].call(i(C.contentSelector)[0],G)}if(E){E.call(i(C.contentSelector)[0],G,C)}};this._setup();return true},_debug:function p(){if(this.options&&this.options.debug){return n.console&&console.log.call(console,arguments)}},_determinepath:function z(C){var B=this.options;if(!!B.behavior&&this["_determinepath_"+B.behavior]!==k){this["_determinepath_"+B.behavior].call(this,C);return}if(!!B.pathParse){this._debug("pathParse manual");return B.pathParse(C,this.options.state.currPage+1)}else{if(C.match(/^(.*?)\b2\b(.*?$)/)){C=C.match(/^(.*?)\b2\b(.*?$)/).slice(1)}else{if(C.match(/^(.*?)2(.*?$)/)){if(C.match(/^(.*?page=)2(\/.*|$)/)){C=C.match(/^(.*?page=)2(\/.*|$)/).slice(1);return C}C=C.match(/^(.*?)2(.*?$)/).slice(1)}else{if(C.match(/^(.*?page=)1(\/.*|$)/)){C=C.match(/^(.*?page=)1(\/.*|$)/).slice(1);return C}else{this._debug("Sorry, we couldn't parse your Next (Previous Posts) URL. Verify your the css selector points to the correct A tag. If you still get this error: yell, scream, and kindly ask for help at infinite-scroll.com.");B.state.isInvalidPage=true}}}}this._debug("determinePath",C);return C},_error:function u(C){var B=this.options;if(!!B.behavior&&this["_error_"+B.behavior]!==k){this["_error_"+B.behavior].call(this,C);return}if(C!=="destroy"&&C!=="end"){C="unknown"}this._debug("Error",C);if(C=="end"){this._showdonemsg()}B.state.isDone=true;B.state.currPage=1;B.state.isPaused=false;this._binding("unbind")},_loadcallback:function c(F,G){var E=this.options,I=this.options.callback,B=(E.state.isDone)?"done":(!E.appendCallback)?"no-append":"append",H;if(!!E.behavior&&this["_loadcallback_"+E.behavior]!==k){this["_loadcallback_"+E.behavior].call(this,F,G);return}switch(B){case"done":this._showdonemsg();return false;break;case"no-append":if(E.dataType=="html"){G="<div>"+G+"</div>";G=i(G).find(E.itemSelector)}break;case"append":var D=F.children();if(D.length==0){return this._error("end")}H=document.createDocumentFragment();while(F[0].firstChild){H.appendChild(F[0].firstChild)}this._debug("contentSelector",i(E.contentSelector)[0]);i(E.contentSelector)[0].appendChild(H);G=D.get();break}E.loading.finished.call(i(E.contentSelector)[0],E);if(E.animate){var C=i(n).scrollTop()+i("#infscr-loading").height()+E.extraScrollPx+"px";i("html,body").animate({scrollTop:C},800,function(){E.state.isDuringAjax=false})}if(!E.animate){E.state.isDuringAjax=false}I(this,G)},_nearbottom:function t(){var C=this.options,B=0+i(document).height()-(C.binder.scrollTop())-i(n).height();if(!!C.behavior&&this["_nearbottom_"+C.behavior]!==k){return this["_nearbottom_"+C.behavior].call(this)}this._debug("math:",B,C.pixelsFromNavToBottom);return(B-C.bufferPx<C.pixelsFromNavToBottom)},_pausing:function l(C){var B=this.options;if(!!B.behavior&&this["_pausing_"+B.behavior]!==k){this["_pausing_"+B.behavior].call(this,C);return}if(C!=="pause"&&C!=="resume"&&C!==null){this._debug("Invalid argument. Toggling pause value instead")}C=(C&&(C=="pause"||C=="resume"))?C:"toggle";switch(C){case"pause":B.state.isPaused=true;break;case"resume":B.state.isPaused=false;break;case"toggle":B.state.isPaused=!B.state.isPaused;break}this._debug("Paused",B.state.isPaused);return false},_setup:function q(){var B=this.options;if(!!B.behavior&&this["_setup_"+B.behavior]!==k){this["_setup_"+B.behavior].call(this);return}this._binding("bind");return false},_showdonemsg:function a(){var B=this.options;if(!!B.behavior&&this["_showdonemsg_"+B.behavior]!==k){this["_showdonemsg_"+B.behavior].call(this);return}B.loading.msg.find("img").hide().parent().find("div").html(B.loading.finishedMsg).animate({opacity:1},2000,function(){i(this).parent().fadeOut("normal")});B.errorCallback.call(i(B.contentSelector)[0],"done")},_validate:function v(C){for(var B in C){if(B.indexOf&&B.indexOf("Selector")>-1&&i(C[B]).length===0){this._debug("Your "+B+" found no elements.");return false}}return true},bind:function o(){this._binding("bind")},destroy:function A(){this.options.state.isDestroyed=true;return this._error("destroy")},pause:function e(){this._pausing("pause")},resume:function h(){this._pausing("resume")},retrieve:function b(H){var I=this,C=I.options,K=C.path,E,J,L,B,D,H=H||null,G=(!!H)?H:C.state.currPage;beginAjax=function F(M){M.state.currPage++;I._debug("heading into ajax",K);E=i(M.contentSelector).is("table")?i("<tbody/>"):i("<div/>");L=K.join(M.state.currPage);B=(M.dataType=="html"||M.dataType=="json")?M.dataType:"html+callback";if(M.appendCallback&&M.dataType=="html"){B+="+callback"}switch(B){case"html+callback":I._debug("Using HTML via .load() method");E.load(L+" "+M.itemSelector,null,function N(O){I._loadcallback(E,O)});break;case"html":case"json":I._debug("Using "+(B.toUpperCase())+" via $.ajax() method");i.ajax({url:L,dataType:M.dataType,complete:function N(O,P){D=(typeof(O.isResolved)!=="undefined")?(O.isResolved()):(P==="success"||P==="notmodified");(D)?I._loadcallback(E,O.responseText):I._error("end")}});break}};if(!!C.behavior&&this["retrieve_"+C.behavior]!==k){this["retrieve_"+C.behavior].call(this,H);return}if(C.state.isDestroyed){this._debug("Instance is destroyed");return false}C.state.isDuringAjax=true;C.loading.start.call(i(C.contentSelector)[0],C)},scroll:function f(){var B=this.options,C=B.state;if(!!B.behavior&&this["scroll_"+B.behavior]!==k){this["scroll_"+B.behavior].call(this);return}if(C.isDuringAjax||C.isInvalidPage||C.isDone||C.isDestroyed||C.isPaused){return}if(!this._nearbottom()){return}this.retrieve()},toggle:function x(){this._pausing()},unbind:function m(){this._binding("unbind")},update:function j(B){if(i.isPlainObject(B)){this.options=i.extend(true,this.options,B)}}};i.fn.infinitescroll=function d(D,E){var C=typeof D;switch(C){case"string":var B=Array.prototype.slice.call(arguments,1);this.each(function(){var F=i.data(this,"infinitescroll");if(!F){return false}if(!i.isFunction(F[D])||D.charAt(0)==="_"){return false}F[D].apply(F,B)});break;case"object":this.each(function(){var F=i.data(this,"infinitescroll");if(F){F.update(D)}else{F=new i.infinitescroll(D,E,this);if(!F.failed){i.data(this,"infinitescroll",F)}}});break}return this};var w=i.event,r;w.special.smartscroll={setup:function(){i(this).bind("scroll",w.special.smartscroll.handler)},teardown:function(){i(this).unbind("scroll",w.special.smartscroll.handler)},handler:function(E,B){var D=this,C=arguments;E.type="smartscroll";if(r){clearTimeout(r)}r=setTimeout(function(){i.event.handle.apply(D,C)},B==="execAsap"?0:100)}};i.fn.smartscroll=function(B){return B?this.bind("smartscroll",B):this.trigger("smartscroll",["execAsap"])}})(window,jQuery);
(function(d){d.timeago=function(g){if(g instanceof Date){return a(g)}else{if(typeof g==="string"){return a(d.timeago.parse(g))}else{return a(d.timeago.datetime(g))}}};var f=d.timeago;d.extend(d.timeago,{settings:{refreshMillis:60000,allowFuture:false,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",wordSeparator:" ",numbers:[]}},inWords:function(m){var n=this.settings.strings;var j=n.prefixAgo;var r=n.suffixAgo;if(this.settings.allowFuture){if(m<0){j=n.prefixFromNow;r=n.suffixFromNow}}var p=Math.abs(m)/1000;var g=p/60;var o=g/60;var q=o/24;var k=q/365;function i(s,u){var t=d.isFunction(s)?s(u,m):s;var v=(n.numbers&&n.numbers[u])||u;return t.replace(/%d/i,v)}var l=p<45&&i(n.seconds,Math.round(p))||p<90&&i(n.minute,1)||g<45&&i(n.minutes,Math.round(g))||g<90&&i(n.hour,1)||o<24&&i(n.hours,Math.round(o))||o<42&&i(n.day,1)||q<30&&i(n.days,Math.round(q))||q<45&&i(n.month,1)||q<365&&i(n.months,Math.round(q/30))||k<1.5&&i(n.year,1)||i(n.years,Math.round(k));var h=n.wordSeparator===undefined?" ":n.wordSeparator;return d.trim([j,l,r].join(h))},parse:function(h){var g=d.trim(h);g=g.replace(/\.\d\d\d+/,"");g=g.replace(/-/,"/").replace(/-/,"/");g=g.replace(/T/," ").replace(/Z/," UTC");g=g.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2");return new Date(g)},datetime:function(h){var g=f.isTime(h)?d(h).attr("datetime"):d(h).attr("title");return f.parse(g)},isTime:function(g){return d(g).get(0).tagName.toLowerCase()==="time"}});d.fn.timeago=function(){var h=this;h.each(c);var g=f.settings;if(g.refreshMillis>0){setInterval(function(){h.each(c)},g.refreshMillis)}return h};function c(){var g=b(this);if(!isNaN(g.datetime)){d(this).text(a(g.datetime))}return this}function b(g){g=d(g);if(!g.data("timeago")){g.data("timeago",{datetime:f.datetime(g)});var h=d.trim(g.text());if(h.length>0&&!(f.isTime(g)&&g.attr("title"))){g.attr("title",h)}}return g.data("timeago")}function a(g){return f.inWords(e(g))}function e(g){return(new Date().getTime()-g.getTime())}document.createElement("abbr");document.createElement("time")}(jQuery));
(function(){function a(e,d,b){var c=e%10;if((c>1)&&(c<5)&&((e>20)||(e<10))){return d}else{return b}}jQuery.timeago.settings.strings={prefixAgo:null,prefixFromNow:"za",suffixAgo:"temu",suffixFromNow:null,seconds:"mniej niż minutę",minute:"minutę",minutes:function(b){return a(b,"%d minuty","%d minut")},hour:"godzinę",hours:function(b){return a(b,"%d godziny","%d godzin")},day:"dzień",days:"%d dni",month:"miesiąc",months:function(b){return a(b,"%d miesiące","%d miesięcy")},year:"rok",years:function(b){return a(b,"%d lata","%d lat")}}})();
jQuery.fn.center=function(){this.css("position","absolute");this.css("top",Math.max(0,(($(window).height()-this.outerHeight())/2)+$(window).scrollTop())+"px");this.css("left",Math.max(0,(($(window).width()-this.outerWidth())/2)+$(window).scrollLeft())+"px");return this};$(function(){poebao.ui.init();$(".top-layer").css({top:"50%",left:"50%",margin:"-"+($(".top-layer").height()/2)+"px 0 0 -"+($(".top-layer").width()/2)+"px"});$(".top-layer .layer-close-button").click(function(){$(".top-layer").hide();$("#darken").hide()});$("#nav-show-upload-form").click(function(){});$("#nav-hide-upload-form").click(function(){});function f(g){if(g!==undefined){var h=$(g).position().top-80;console.log("y:"+h);$("html, body").animate({scrollTop:h},200)}}if(window.location.hash){var e=window.location.hash.substr(6);f("#"+e)}var d=$(".post-element");var b=0;$(window).bind("keydown","j",function(){f(d[++b])});$(window).bind("keydown","k",function(){if(b>0){f(d[--b])}});$(window).bind("keydown","r",function(){console.log('"r" pressed - rate')});$(window).bind("keydown","c",function(){console.log('"c" pressed - comment')});$(window).bind("keydown","h",function(){console.log('"h" pressed - hate')});$(window).bind("keydown","l",function(){console.log('"l" pressed - like')});$("input").blur(function(){var g=$(this).parent().prev().find("label").attr("for");a(g)});function a(i){var g="/async/validate/post";var h={};$("input").each(function(){h[$(this).attr("name")]=$(this).val()});$.post(g,h,function(j){$("#"+i).parent().find(".errors").remove();$("#"+i).parent().prepend(c(j[i],i))},"json")}function c(g,i){var h='<ul id="errors-'+i+'" class="errors">';for(errorKey in g){h+="<li>"+g[errorKey]+"</li>"}h+="</ul>";return h}$("#posts").infinitescroll({loading:{finished:undefined,finishedMsg:"<em>Congratulations, you've reached the end of the internet.</em>",img:"/img/loader.gif",msgText:"",msg:null,selector:null,speed:"fast",start:undefined},state:{isDuringAjax:false,isInvalidPage:false,isDestroyed:false,isDone:false,isPaused:false,currPage:1},callback:function(){},debug:false,behavior:undefined,binder:$(window),navSelector:"#paginator",nextSelector:"#nav-post-list-next-page",extraScrollPx:150,itemSelector:"ul.post-list",animate:false,pathParse:undefined,dataType:"html",appendCallback:true,bufferPx:40,errorCallback:function(){},infid:0,pixelsFromNavToBottom:100,path:undefined},poebao.ui.infiniteScrollLoaded)});
function removeFromUrl(){$("#upload-from-url").remove()}function removeFromFile(){$("#upload-from-file").remove();$("#upload-from-file-source").remove()}function addFromFile(){$("#upload-from-url").parent().prepend('<tr id="upload-from-file"><td id="file-label"><label for="file" class="required">Wgraj z dysku <span>(<a id="nav-upload-form-switch-source" href="?uploadfromfile=0">lub z url</a>)</span></label></td><td class="element"><input type="hidden" name="MAX_FILE_SIZE" value="15728640" id="MAX_FILE_SIZE"><input type="file" name="file" id="file" class="file"></td></tr>')}function addFromUrl(){$("#upload-from-file").parent().prepend('<tr id="upload-from-url"><td id="file-label"><label for="file" class="required">url pliku <span>(<a id="nav-upload-form-switch-source" href="?uploadfromfile=1">lub dodaj z dysku</a>)</span></label></td><td class="element"><input type="text" name="file" id="file" value="" placeholder="http://www" class="poebao"><p class="hidden">A to jest opis pola WWW</p></td></tr>')};
var poebao={};poebao.ui={init:function(){$(window).scroll(poebao.ui.evntScrollWindow);poebao.ui.evntScrollWindow();poebao.ui.cropPostAgoPictures();$("time.timeago").timeago()},infiniteScrollLoaded:function(){$("time.timeago").timeago();FB.XFBML.parse();gapi.plusone.go()},stickyAdditional:function(e){var f=$("#scroller-anchor").offset().top;var g=$("#scroller");var a=$("#header-container").height();var b=a+20;if(e>f-b){g.css({position:"fixed",top:b+"px"})}else{if(e<=f+b){g.css({position:"relative",top:""})}}},cropPostAgoPictures:function(){poebao.ui.cropPostAgoPicture($("#posts-ago-0 img"),{width:160,height:210});poebao.ui.cropPostAgoPicture($("#posts-ago-1 img"),{width:120,height:100});poebao.ui.cropPostAgoPicture($("#posts-ago-2 img"),{width:120,height:100})},cropPostAgoPicture:function(a,b){$("<img/>").attr("src",a.attr("src")).load(function(){width=this.width;height=this.height;if(width>height){a.css("height",b.height);var c=(a.width()-b.width)/-2;a.css("margin-left",c)}else{a.css("width",b.width);var d=(a.height()-b.height)/-2;a.css("margin-top",d)}})},minimizingHeader:function(a){if(a>50){poebao.ui.minimizeHeader()}else{poebao.ui.maximizeHeader()}},minimizeHeader:function(){var a=100;$("#header img").animate({width:"120px"},{duration:a,queue:false});$("#header").animate({height:"52px"},{duration:a,queue:false});$("#header").animate({"padding-top":"0px"},{duration:a,queue:false});$("#nav").animate({"margin-top":"12px"},{duration:a,queue:false})},maximizeHeader:function(){var a=100;$("#header").animate({height:"85px"},{duration:a,queue:false});$("#header").animate({"padding-top":"15px"},{duration:a,queue:false});$("#nav").animate({"margin-top":"23px"},{duration:a,queue:false});$("#header img").animate({width:"179px"},{duration:a,queue:false})},evntScrollWindow:function(){var a=$(window).scrollTop();poebao.ui.stickyAdditional(a);poebao.ui.minimizingHeader(a)}};
